
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CRM ERD — Pro Theme</title>

  <script src="https://unpkg.com/gojs/release/go.js"></script>
  <script src="https://gojs.net/latest/extensions/Themes.js"></script>
  <script src="https://gojs.net/latest/extensions/Figures.js"></script>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: ui-sans-serif, sans-serif;
    }
    #myDiagramDiv {
      width: 100%;
      height: calc(100vh - 64px);
    }
  </style>
</head>
<body>
<header style="height:64px;background:#1e3a8a;color:white;display:flex;align-items:center;justify-content:space-between;padding:0 1rem;">
  <h1 style="font-weight:bold;font-size:1.2rem;">CRM ERD — Pro Theme</h1>
  <select id="theme" onchange="changeTheme()" style="padding:0.25rem 0.5rem;border-radius:4px;">
    <option value="system">System</option>
    <option value="light">Light</option>
    <option value="dark">Dark</option>
  </select>
</header>
<div id="myDiagramDiv"></div>
<script>
function init() {
  const $ = go.GraphObject.make;
  const diagram = $(go.Diagram, "myDiagramDiv", {
    layout: $(go.ForceDirectedLayout),
    "undoManager.isEnabled": true,
    "themeManager.themeMap": new go.Map([
      { key: "light", value: Modern },
      { key: "dark", value: ModernDark }
    ]),
    "themeManager.currentTheme": document.getElementById("theme").value
  });

  const itemTempl = $(go.Panel, "Horizontal", { margin: 2 })
    .add(
      $(go.Shape,
        { desiredSize: new go.Size(10, 10), margin: 4, strokeWidth: 0 },
        new go.Binding("figure", "figure"),
        new go.Binding("fill", "color")
      ),
      $(go.TextBlock,
        { font: "12px monospace" },
        new go.Binding("text", "name")
      )
    );

  diagram.nodeTemplate = $(
    go.Node, "Auto",
    $(go.Shape, "RoundedRectangle",
      { strokeWidth: 2 },
      new go.Binding("fill", "color")
    ),
    $(go.Panel, "Table",
      { margin: 6, stretch: go.Stretch.Fill },
      $(go.TextBlock,
        { row: 0, columnSpan: 2, alignment: go.Spot.Center, font: "bold 14px sans-serif", margin: 4 },
        new go.Binding("text", "key")
      ),
      $(go.Panel, "Vertical",
        { row: 1, columnSpan: 2 },
        $(go.TextBlock, "Attributes", { font: "bold 12px sans-serif", margin: new go.Margin(4, 0, 2, 0) }),
        $(go.Panel, "Vertical",
          new go.Binding("itemArray", "items"),
          { itemTemplate: itemTempl }
        )
      ),
      $(go.Panel, "Vertical",
        { row: 2, columnSpan: 2 },
        new go.Binding("visible", "inheritedItems", arr => Array.isArray(arr) && arr.length > 0),
        $(go.TextBlock, "Inherited", { font: "bold 12px sans-serif", margin: new go.Margin(6, 0, 2, 0) }),
        $(go.Panel, "Vertical",
          new go.Binding("itemArray", "inheritedItems"),
          { itemTemplate: itemTempl }
        )
      )
    )
  );

  diagram.linkTemplate = $(
    go.Link,
    { routing: go.Link.AvoidsNodes, curve: go.Link.JumpOver },
    $(go.Shape),
    $(go.Shape, { toArrow: "OpenTriangle" }),
    $(go.TextBlock,
      { segmentOffset: new go.Point(0, -10), font: "10px sans-serif" },
      new go.Binding("text", "text"))
  );

  diagram.model = new go.GraphLinksModel([{"key": "contacts", "items": [{"name": "first_name", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "last_name", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "email", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "phone", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [{"name": "id", "figure": "Decision", "color": "purple", "iskey": true}], "color": "#93c5fd", "loc": "0 0"}, {"key": "organizations", "items": [{"name": "name", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "website", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "type", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#93c5fd", "loc": "0 0"}, {"key": "artists", "items": [{"name": "name", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "genre", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "contact", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#93c5fd", "loc": "0 0"}, {"key": "deals", "items": [{"name": "title", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "value", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "stage", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#fde68a", "loc": "0 0"}, {"key": "proposals", "items": [{"name": "name", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "status", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "contact", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#fde68a", "loc": "0 0"}, {"key": "events", "items": [{"name": "name", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "date", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "venue", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#6ee7b7", "loc": "0 0"}, {"key": "bookings", "items": [{"name": "event", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "artist", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "status", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#6ee7b7", "loc": "0 0"}, {"key": "logistics", "items": [{"name": "transport", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "crew", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "notes", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#6ee7b7", "loc": "0 0"}, {"key": "invoices", "items": [{"name": "number", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "amount", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "due_date", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#fecdd3", "loc": "0 0"}, {"key": "contracts", "items": [{"name": "name", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "signed_by", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "status", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#fecdd3", "loc": "0 0"}, {"key": "tasks", "items": [{"name": "title", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "deadline", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "assigned_to", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#ddd6fe", "loc": "0 0"}, {"key": "updates", "items": [{"name": "update", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "timestamp", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#ddd6fe", "loc": "0 0"}, {"key": "inbox", "items": [{"name": "subject", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "from", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "received_at", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#bae6fd", "loc": "0 0"}, {"key": "conversations", "items": [{"name": "topic", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "participants", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#bae6fd", "loc": "0 0"}, {"key": "messages", "items": [{"name": "body", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "sent_at", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "sender", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#bae6fd", "loc": "0 0"}, {"key": "directus_users", "items": [{"name": "email", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "role", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#e5e7eb", "loc": "0 0"}, {"key": "directus_roles", "items": [{"name": "name", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "app_access", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#e5e7eb", "loc": "0 0"}, {"key": "directus_files", "items": [{"name": "filename", "figure": "Hexagon", "color": "blue", "iskey": false}, {"name": "type", "figure": "Hexagon", "color": "blue", "iskey": false}], "inheritedItems": [], "color": "#e5e7eb", "loc": "0 0"}], [{"from": "contacts", "to": "organizations", "text": "works for"}, {"from": "contacts", "to": "artists", "text": "manages"}, {"from": "artists", "to": "events", "text": "performs at"}, {"from": "bookings", "to": "events", "text": "booking for"}, {"from": "bookings", "to": "artists", "text": "artist"}, {"from": "proposals", "to": "contacts", "text": "sent to"}, {"from": "deals", "to": "proposals", "text": "based on"}, {"from": "contracts", "to": "bookings", "text": "contracted"}, {"from": "invoices", "to": "contracts", "text": "billed for"}, {"from": "tasks", "to": "updates", "text": "progress"}, {"from": "conversations", "to": "messages", "text": "contains"}, {"from": "inbox", "to": "messages", "text": "delivers"}, {"from": "contacts", "to": "directus_users", "text": "linked user"}, {"from": "directus_users", "to": "directus_roles", "text": "has role"}]);
}

function changeTheme() {
  const diagram = go.Diagram.fromDiv("myDiagramDiv");
  diagram.themeManager.currentTheme = document.getElementById("theme").value;
}

window.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html>
